(this.webpackJsonpmind_chess=this.webpackJsonpmind_chess||[]).push([[0],{104:function(e,t){},106:function(e,t){},110:function(e,t,a){},111:function(e,t,a){},112:function(e,t,a){},119:function(e,t,a){},120:function(e,t,a){},121:function(e,t,a){},122:function(e,t,a){},123:function(e,t,a){},124:function(e,t,a){},125:function(e,t,a){},126:function(e,t,a){},127:function(e,t,a){},128:function(e,t,a){},129:function(e,t,a){},130:function(e,t,a){},131:function(e,t,a){"use strict";a.r(t);var s=a(1),n=a.n(s),c=a(49),r=a.n(c),l=a(16),i=a(5),o=a(4),j=Object(s.createContext)(),d=a(2),b="SET_CHESS_CLIENT",u="SET_START_GAME",m="SET_MOVES_PGN",O="SET_MOVES_FEN",h="SET_MY_TURN",g="SET_GAME_STATUS",x="RESET_GAME_STATE",p="SET_HOST",f="SET_GAME_CODE",v="SET_OPP_USERNAME",N="SET_OPP_START_GAME",w="SET_RECEIVED_SETTINGS",y="SET_HUMAN_GAME_STATUS",S="SET_OFFER_REMATCH",k="SET_OFFER_DRAW",C="SET_REQUEST_TAKEBACK",T="RESET_HUMAN_GAME_STATE",E="SET_P2PT",M="SET_OPP_PEER_OBJ",_="SET_ALL_SETTINGS",A="SET_COLOUR",R="SET_USERNAME",P="SET_ENTER_BY_KEYBOARD",G="SET_SHOW",B="SET_TIMES_TO_SHOW",D="SET_ALLOW",F="SET_TIMES_ALLOWED",V="SET_ALL_COUNTERS",W="SET_COUNTER",U="DECREMENT_COUNTER",L=function(e,t){var a=t.payload;switch(t.type){case b:return Object(d.a)(Object(d.a)({},e),{},{chessClient:a});case u:return Object(d.a)(Object(d.a)({},e),{},{startGame:a});case m:return Object(d.a)(Object(d.a)({},e),{},{movesPgn:a});case O:return Object(d.a)(Object(d.a)({},e),{},{movesFen:a});case h:return Object(d.a)(Object(d.a)({},e),{},{myTurn:a});case g:return Object(d.a)(Object(d.a)({},e),{},{gameStatus:a});case x:return Object(d.a)(Object(d.a)({},e),a);default:return Object(d.a)({},e)}},H=a(50),I=a(51),K=a.n(I),q="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",J=["wss://tracker.openwebtorrent.com","wss://tracker.sloppyta.co:443/announce","wss://tracker.novage.com.ua:443/announce","wss://tracker.btorrent.xyz:443/announce"];"localhost"===window.location.hostname&&(J=["ws://localhost:5000"]);var Q=1e4,Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q;return new K.a(e)},$={starting:{main:"New Game",reason:null},active:{main:"Active Game",reason:null},whiteWon:{main:"White Won",reason:"Checkmate"},blackWon:{main:"Black Won",reason:"Checkmate"},drawByStalemate:{main:"Draw",reason:"Stalemate"},drawByRepetition:{main:"Draw",reason:"Threefold Repetition"},drawByInsufficientMaterial:{main:"Draw",reason:"Insufficient Material"},drawBy50MoveRule:{main:"Draw",reason:"50 Move Rule"}},z=function e(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q;Object(H.a)(this,e),this.reset=function(){return t.client.reset()},this.move=function(e){return t.client.move(e,{sloppy:!0})},this.isValidMove=function(e){return null!=Y(t.client.fen()).move(e,{sloppy:!0})},this.getLegalMoves=function(){return t.client.moves()},this.getMoveHistory=function(){return t.client.history()},this.undoMove=function(){return t.client.undo()},this.getPgn=function(){return t.client.pgn()},this.getFen=function(){return t.client.fen()},this.gameHistory=function(){return t.client.history()},this.loadPosition=function(e){return t.client.load(e)},this.getStatus=function(){var e=t.client;return 0===e.history().length?$.starting:e.in_checkmate()?"b"===e.turn()?$.whiteWon:$.blackWon:e.in_stalemate()?$.drawByStalemate:e.in_threefold_repetition()?$.drawByRepetition:e.insufficient_material()?$.drawByInsufficientMaterial:e.in_draw()?$.drawBy50MoveRule:$.active},this.client=Y(a)},X=a(0),Z={chessClient:new z(q),startGame:!1,movesPgn:null,movesFen:q,myTurn:!0,gameStatus:"New Game"},ee=function(e){var t=Z,a=Object(s.useReducer)(L,t),n=Object(o.a)(a,2),c=n[0],r=n[1];return Object(X.jsx)(j.Provider,{value:{chessClient:c.chessClient,startGame:c.startGame,movesPgn:c.movesPgn,movesFen:c.movesFen,myTurn:c.myTurn,gameStatus:c.gameStatus,setChessClient:function(e){r({type:b,payload:e})},setStartGame:function(e){r({type:u,payload:e})},setMovesPgn:function(e){r({type:m,payload:e})},setMovesFen:function(e){r({type:O,payload:e})},setMyTurn:function(e){r({type:h,payload:e})},setGameStatus:function(e){r({type:g,payload:e})},resetGameState:function(){r({type:x,payload:Z})}},children:e.children})},te=Object(s.createContext)(),ae=function(e,t){var a=t.payload;switch(t.type){case v:return Object(d.a)(Object(d.a)({},e),{},{oppUsername:a});case N:return Object(d.a)(Object(d.a)({},e),{},{oppStartGame:a});case w:return Object(d.a)(Object(d.a)({},e),{},{receivedSettings:a});case p:return Object(d.a)(Object(d.a)({},e),{},{isHost:!0});case f:return Object(d.a)(Object(d.a)({},e),{},{gameCode:a});case y:return Object(d.a)(Object(d.a)({},e),{},{gameStatus:a});case k:return Object(d.a)(Object(d.a)({},e),{},{offerDraw:a});case S:return Object(d.a)(Object(d.a)({},e),{},{offerRematch:a});case C:return Object(d.a)(Object(d.a)({},e),{},{requestTakeback:a});case T:return Object(d.a)(Object(d.a)({},e),a);default:return Object(d.a)({},e)}},se={gameCode:"",isHost:!1,oppUsername:"",oppStartGame:!1,receivedSettings:!1,gameStatus:{main:"New Game",winner:null,reason:null,rematchOffered:!1,drawOffered:!1,takebackRequested:!1},offerRematch:!1,offerDraw:!1,requestTakeback:!1},ne=function(e){var t=se,a=Object(s.useReducer)(ae,t),n=Object(o.a)(a,2),c=n[0],r=n[1];return Object(X.jsx)(te.Provider,{value:{gameCode:c.gameCode,isHost:c.isHost,oppUsername:c.oppUsername,oppStartGame:c.oppStartGame,receivedSettings:c.receivedSettings,gameStatus:c.gameStatus,offerRematch:c.offerRematch,offerDraw:c.offerDraw,requestTakeback:c.requestTakeback,setHost:function(){r({type:p,payload:null})},setGameCode:function(e){r({type:f,payload:e})},setOppUsername:function(e){r({type:v,payload:e})},setOppStartGame:function(e){r({type:N,payload:e})},setReceivedSettings:function(e){r({type:w,payload:e})},setGameStatus:function(e){r({type:y,payload:e})},setOfferRematch:function(e){r({type:S,payload:e})},setOfferDraw:function(e){r({type:k,payload:e})},setRequestTakeback:function(e){r({type:C,payload:e})},resetHumanGameState:function(){r({type:T,payload:{oppStartGame:!1,receivedSettings:!1,gameStatus:{main:"New Game",winner:null,reason:null,rematchOffered:!1,drawOffered:!1,takebackRequested:!1}}})}},children:e.children})},ce=Object(s.createContext)(),re=function(e,t){switch(t.type){case E:return Object(d.a)(Object(d.a)({},e),{},{p2pt:t.payload});case M:return Object(d.a)(Object(d.a)({},e),{},{oppPeerObj:t.payload});default:return Object(d.a)({},e)}},le="USER_NAME",ie="SETTINGS",oe="MOVE",je="CHESS_CLIENT",de="GAME_STATUS",be="START_GAME",ue="OFFER_REMATCH",me="REMATCH_OFFER_ACCEPTED",Oe="REMATCH_OFFER_DECLINED",he="OFFER_DRAW",ge="DRAW_OFFER_ACCEPTED",xe="DRAW_OFFER_DECLINED",pe="REQUEST_TAKEBACK",fe="TAKEBACK_REQUEST_ACCEPTED",ve="TAKEBACK_REQUEST_DECLINED",Ne="RESIGN",we="ILLEGAL_MOVE_LOST",ye={p2pt:null,oppPeerObj:null},Se=function(e){var t=ye,a=Object(s.useReducer)(re,t),n=Object(o.a)(a,2),c=n[0],r=n[1];return Object(X.jsx)(ce.Provider,{value:{p2pt:c.p2pt,oppPeerObj:c.oppPeerObj,setP2pt:function(e){r({type:E,payload:e})},setOppPeerObj:function(e){r({type:M,payload:e})},sendSignal:function(e){if(c.oppPeerObj){var t={type:e};c.p2pt.send(c.oppPeerObj,JSON.stringify(t))}},sendUsername:function(e){if(c.oppPeerObj){var t={type:le,username:e};c.p2pt.send(c.oppPeerObj,JSON.stringify(t))}},sendSettings:function(e){if(c.oppPeerObj){var t=Object(d.a)({},e);delete t.username;var a={type:ie,settings:t};c.p2pt.send(c.oppPeerObj,JSON.stringify(a))}},sendMove:function(e){if(c.oppPeerObj){var t={type:oe,move:e};c.p2pt.send(c.oppPeerObj,JSON.stringify(t))}},sendChessClient:function(e){if(c.oppPeerObj){var t={type:je,newClient:e};c.p2pt.send(c.oppPeerObj,JSON.stringify(t))}},sendGameStatus:function(e){if(c.oppPeerObj){var t={type:de,gameStatus:e};c.p2pt.send(c.oppPeerObj,JSON.stringify(t))}}},children:e.children})},ke=Object(s.createContext)(),Ce=a(12),Te=function(e,t){var a,s=t.payload||{},n=s.settings,c=s.settingName,r=s.settingValue,l=e.show,i=e.timesToShow,o=e.allow,j=e.timesAllowed;switch(t.type){case _:return Object(d.a)(Object(d.a)({},e),n);case A:return Object(d.a)(Object(d.a)({},e),{},{colour:r});case R:return Object(d.a)(Object(d.a)({},e),{},{username:r});case P:var b=e.enterByKeyboard;return Object(d.a)(Object(d.a)({},e),{},{enterByKeyboard:!b});case G:return a=l[c],Object(d.a)(Object(d.a)({},e),{},{show:Object(d.a)(Object(d.a)({},l),{},Object(Ce.a)({},c,!a))});case B:return Object(d.a)(Object(d.a)({},e),{},{timesToShow:Object(d.a)(Object(d.a)({},i),{},Object(Ce.a)({},c,r))});case D:return a=o[c],Object(d.a)(Object(d.a)({},e),{},{allow:Object(d.a)(Object(d.a)({},o),{},Object(Ce.a)({},c,!a))});case F:return Object(d.a)(Object(d.a)({},e),{},{timesAllowed:Object(d.a)(Object(d.a)({},j),{},Object(Ce.a)({},c,r))});default:return Object(d.a)({},e)}},Ee=function(e){var t={username:"",colour:"White",enterByKeyboard:!0,show:{legalMoves:!1,movesTable:!0,board:!0,mate:!0,checks:!0,captures:!0},timesToShow:{legalMoves:Q,movesTable:Q,board:Q},allow:{illegalMove:!0,takeBack:!0},timesAllowed:{illegalMove:Q,takeBack:Q},illegalMoveLoss:!1},a=Object(s.useReducer)(Te,t),n=Object(o.a)(a,2),c=n[0],r=n[1];return Object(X.jsx)(ke.Provider,{value:{username:c.username,colour:c.colour,enterByKeyboard:c.enterByKeyboard,show:c.show,timesToShow:c.timesToShow,allow:c.allow,timesAllowed:c.timesAllowed,setSettings:{setAllSettings:function(e){r({type:_,payload:{settings:e}})},setColour:function(e){r({type:A,payload:{settingValue:e}})},setUsername:function(e){r({type:R,payload:{settingValue:e}})},setEnterByKeyboard:function(){r({type:P,payload:null})},setShow:function(e){r({type:G,payload:{settingName:e}})},setTimesToShow:function(e,t){r({type:B,payload:{settingName:e,settingValue:t}})},setAllow:function(e){r({type:D,payload:{settingName:e}})},setTimesAllowed:function(e,t){r({type:F,payload:{settingName:e,settingValue:t}})}}},children:e.children})},Me=Object(s.createContext)(),_e=function(e,t){var a=t.payload,s=a.counterName,n=a.counterValue,c=a.timesToShow,r=a.timesAllowed,l=e[s];switch(t.type){case V:return Object(d.a)(Object(d.a)(Object(d.a)({},e),c),r);case W:return Object(d.a)(Object(d.a)({},e),{},Object(Ce.a)({},s,n));case U:return Object(d.a)(Object(d.a)({},e),{},Object(Ce.a)({},s,l-1));default:return Object(d.a)({},e)}},Ae=function(e){var t={legalMoves:1/0,movesTable:1/0,board:1/0,illegalMoves:1/0,takebacks:1/0},a=Object(s.useReducer)(_e,t),n=Object(o.a)(a,2),c=n[0],r=n[1];return Object(X.jsx)(Me.Provider,{value:{legalMoves:c.legalMoves,movesTable:c.movesTable,board:c.board,illegalMoves:c.illegalMoves,takebacks:c.takebacks,setAllCounters:function(e){r({type:V,payload:e})},setCounter:function(e,t){r({type:W,payload:{counterName:e,counterValue:t}})},decrementCounter:function(e){r({type:U,payload:{counterName:e}})}},children:e.children})},Re=a(6),Pe=a(8),Ge=(a(64),function(){return Object(X.jsxs)("nav",{className:"navbar",children:[Object(X.jsx)("div",{className:"nav-brand",children:Object(X.jsxs)(l.b,{to:"/",className:"text-link",children:[Object(X.jsx)(Re.a,{icon:Pe.b,color:"#ffe0bd"}),Object(X.jsx)("span",{children:"\xa0MindChess"})]})}),Object(X.jsx)("div",{className:"nav-menu",children:Object(X.jsxs)("ul",{className:"nav-items",children:[Object(X.jsx)("li",{className:"nav-item",children:Object(X.jsxs)(l.b,{to:"/about",children:[Object(X.jsx)(Re.a,{icon:Pe.d,color:"#f0ad4e"}),Object(X.jsx)("span",{children:"\xa0About"})]})}),Object(X.jsx)("li",{className:"nav-item",children:Object(X.jsxs)(l.b,{to:"/help",children:[Object(X.jsx)(Re.a,{icon:Pe.g,color:"#5bc0de"}),Object(X.jsx)("span",{children:"\xa0Help"})]})})]})})]})}),Be=(a(67),function(){return Object(X.jsx)("footer",{className:"footer",children:Object(X.jsxs)("h3",{className:"footer-text",children:["Made by",Object(X.jsx)("a",{href:"https://pranav.dev",target:"_blank",rel:"noopener noreferrer",children:Object(X.jsx)("span",{children:"\xa0@pranavmodx"})})]})})}),De=(a(68),function(){return Object(X.jsx)("main",{className:"main-home",children:Object(X.jsx)("div",{className:"home-container",children:Object(X.jsx)("button",{className:"btn-lg is-left",children:Object(X.jsxs)(l.b,{to:"/play/friend",children:[Object(X.jsx)(Re.a,{icon:Pe.i}),Object(X.jsx)("span",{children:"\xa0Play against Friend"})]})})})})}),Fe=(a(69),a(70),function(e){var t=e.setView,a=Object(s.useState)(""),n=Object(o.a)(a,2),c=n[0],r=n[1],l=Object(s.useState)(""),i=Object(o.a)(l,2),j=i[0],d=i[1],b=Object(s.useContext)(te),u=b.setHost,m=b.setGameCode,O=Object(s.useContext)(ke).setSettings.setUsername;return Object(X.jsx)("main",{children:Object(X.jsxs)("div",{className:"container",children:[Object(X.jsx)("div",{className:"container-input",children:Object(X.jsx)("input",{id:"name",type:"text",placeholder:"Enter your name",value:j,onChange:function(e){return d(e.target.value)}})}),Object(X.jsx)("button",{className:"btn-lg mt-5",onClick:function(){var e=Math.random().toString(36).substr(2,4);console.log("Game code :",e),m(e),O(j),u(),t(1)},children:"Host Game"}),Object(X.jsx)("div",{className:"separator mt-3 mb-3",children:Object(X.jsx)("h2",{children:"OR"})}),Object(X.jsx)("div",{className:"container-input",children:Object(X.jsx)("input",{type:"text",placeholder:"Enter game code",onChange:function(e){return r(e.target.value)}})}),Object(X.jsx)("button",{className:"btn-lg",onClick:function(){m(c),O(j),t(1)},children:"Join Game"})]})})}),Ve=a(71),We=function(){var e=Object(s.useContext)(ce),t=e.p2pt,a=e.setP2pt,n=e.setOppPeerObj,c=Object(s.useContext)(j),r=c.chessClient,l=c.setChessClient,i=c.setMovesPgn,o=c.setMovesFen,b=c.setMyTurn,u=c.resetGameState,m=Object(s.useContext)(te),O=(m.colour,m.gameCode),h=(m.gameStatus,m.setGameStatus),g=m.setOppUsername,x=m.setOppStartGame,p=m.setReceivedSettings,f=m.setOfferDraw,v=m.setOfferRematch,N=m.setRequestTakeback,w=m.resetHumanGameState,y=Object(s.useContext)(ke),S=y.username,k=y.setSettings.setAllSettings;Object(s.useEffect)((function(){t||function(){var e=new Ve(J,"Blindfold Chess"+O);a(e),e.on("trackerconnect",(function(e,t){console.log("Connected to tracker : "+e.announceUrl),console.log("Tracker stats : "+JSON.stringify(t))})),e.on("peerconnect",(function(t){console.log("Peer connected!"),console.log("Peer : ",t),n(t);var a={type:le,username:S};e.send(t,JSON.stringify(a))})),e.on("peerclose",(function(e){console.log("Peer disconnected!"),console.log("Peer : ",e),n(null)})),e.on("msg",(function(e,t){switch((t=JSON.parse(t)).type){case be:console.log("start game signal received"),x(!0);break;case ue:console.log("rematch signal received");break;case me:console.log("rematch accepted signal received"),v(!1),w(),u();break;case Oe:console.log("rematch declined signal received"),v(!1);break;case he:console.log("draw offer signal received");break;case ge:console.log("draw offer signal received"),f(!1);break;case xe:console.log("draw offer declined signal received"),f(!1);break;case pe:console.log("draw offer signal received");break;case fe:console.log("takeback accepted signal received"),N(!1),r.undoMove(),b(!0);break;case ve:console.log("takeback declined signal received"),N(!1);break;case Ne:console.log("resign signal received");break;case we:console.log("illegal move lost signal received");break;case le:console.log("opp username received : ",t.username),g(t.username);break;case ie:console.log("settings msg received");var a=Object(d.a)({},t.settings);"White"===a.colour?a.colour="Black":a.colour="White",k(a),p(!0);break;case oe:console.log("move msg received"),r.move(t.move),i(r.getPgn()),o(r.getFen()),b(!0);break;case je:console.log("chess client msg received"),l(t.newClient),b(!0);break;case de:console.log("game status received"),h(t.gameStatus)}})),e.start()}()}),[])},Ue=a(53),Le=a.n(Ue),He=(a(110),function(e){var t=e.name,a=e.id,s=e.currentValue,n=e.defaultChecked,c=e.disabled,r=e.onChange,l=e.small,i=e.text;return Object(X.jsxs)("div",{className:"toggle-switch"+(l?" small-switch":""),children:[Object(X.jsx)("input",{type:"checkbox",name:t,className:"toggle-switch-checkbox",id:a,checked:s,defaultChecked:n,onChange:r,disabled:c}),a?Object(X.jsxs)("label",{className:"toggle-switch-label",htmlFor:a,children:[Object(X.jsx)("span",{className:c?"toggle-switch-inner toggle-switch-disabled":"toggle-switch-inner","data-yes":i[0],"data-no":i[1]}),Object(X.jsx)("span",{className:c?"toggle-switch-switch toggle-switch-disabled":"toggle-switch-switch"})]}):null]})});He.defaultProps={text:["Yes","No"]};var Ie=He,Ke=(a(111),function(e){var t=e.disabled,a=Object(s.useContext)(ke),n=a.enterByKeyboard,c=a.show,r=a.allow,l=a.colour,i=a.setSettings,o=i.setColour,j=i.setEnterByKeyboard,d=i.setShow,b=i.setAllow,u=i.setTimesToShow,m=i.setTimesAllowed,O=[1,3,5,1/0];return Object(X.jsx)("div",{className:"gen-settings",children:Object(X.jsx)("table",{className:"settings-table",children:Object(X.jsxs)("tbody",{children:[Object(X.jsxs)("tr",{className:"settings-item",children:[Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("h3",{className:"text",children:"Colour"})}),Object(X.jsx)("td",{className:"settings-value",children:Object(X.jsxs)("div",{className:"btn-group",children:[Object(X.jsx)("button",{className:"btn ".concat("White"===l?"highlight":""),onClick:function(){return o("White")},disabled:t,children:Object(X.jsx)("h3",{className:"text",children:"White"})}),Object(X.jsx)("button",{className:"btn ".concat("Black"===l?"highlight":""),onClick:function(){return o("Black")},disabled:t,children:Object(X.jsx)("h3",{className:"text",children:"Black"})})]})})]}),Object(X.jsxs)("tr",{className:"settings-item",children:[Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("h3",{className:"text",children:"Enter Moves by Keyboard"})}),Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)(Ie,{name:"enterByKeyboard",id:"enterByKeyboard",small:!0,currentValue:n,onChange:j,disabled:t})})]}),Object(X.jsxs)("tr",{className:"settings-item",children:[Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("h3",{className:"text",children:"Show Moves"})}),Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)(Ie,{name:"movesTable",id:"showMovesTable",small:!0,currentValue:c.movesTable,onChange:function(e){return d(e.target.name)},disabled:t})})]}),c.movesTable&&Object(X.jsxs)(X.Fragment,{children:[Object(X.jsxs)("tr",{className:"settings-item",children:[Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("h3",{className:"text",children:"Times to Show Moves"})}),Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("select",{className:"settings-select",name:"movesTable",id:"timesToShowMovesTable",defaultValue:1/0,onChange:function(e){return u(e.target.name,Number(e.target.value))},disabled:t,children:O.map((function(e,t){return Object(X.jsx)("option",{value:e,children:e},t)}))})})]}),Object(X.jsxs)("tr",{className:"settings-item",children:[Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("h3",{className:"text",children:"Show Mate"})}),Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)(Ie,{name:"mate",id:"showMate",small:!0,currentValue:c.mate,onChange:function(e){return d(e.target.name)},disabled:t})})]}),Object(X.jsxs)("tr",{className:"settings-item",children:[Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("h3",{className:"text",children:"Show Checks"})}),Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)(Ie,{name:"checks",id:"showChecks",small:!0,currentValue:c.checks,onChange:function(e){return d(e.target.name)},disabled:t})})]}),Object(X.jsxs)("tr",{className:"settings-item",children:[Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("h3",{className:"text",children:"Show Captures"})}),Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)(Ie,{name:"captures",id:"showCaptures",small:!0,currentValue:c.captures,onChange:function(e){return d(e.target.name)},disabled:t})})]})]}),Object(X.jsxs)("tr",{className:"settings-item",children:[Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("h3",{className:"text",children:"Show Legal Moves"})}),Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)(Ie,{name:"legalMoves",id:"showLegalMoves",small:!0,currentValue:c.legalMoves,onChange:function(e){return d(e.target.name)},disabled:t})})]}),c.legalMoves&&Object(X.jsxs)("tr",{className:"settings-item",children:[Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("h3",{className:"text",children:"Times to Show Legal Moves"})}),Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsxs)("select",{className:"settings-select",name:"legalMoves",id:"timesToShowLegalMoves",defaultValue:1/0,onChange:function(e){return u(e.target.name,Number(e.target.value))},disabled:t,children:[O.map((function(e,t){return Object(X.jsx)("option",{value:e,children:e},t)})),"disabled=",t]})})]}),Object(X.jsxs)("tr",{className:"settings-item",children:[Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("h3",{className:"text",children:"Show Board"})}),Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)(Ie,{name:"board",id:"showBoard",small:!0,currentValue:c.board,onChange:function(e){return d(e.target.name)},disabled:t})})]}),c.board&&Object(X.jsxs)("tr",{className:"settings-item",children:[Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("h3",{className:"text",children:"Times to Show Board"})}),Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsxs)("select",{className:"settings-select",name:"legalMoves",id:"timesToShowLegalMoves",defaultValue:1/0,onChange:function(e){return u(e.target.name,Number(e.target.value))},disabled:t,children:[O.map((function(e,t){return Object(X.jsx)("option",{value:e,children:e},t)})),"disabled=",t]})})]}),Object(X.jsxs)("tr",{className:"settings-item",children:[Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("h3",{className:"text",children:"Allow Illegal Moves"})}),Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)(Ie,{name:"illegalMove",id:"allowIllegalMove",small:!0,currentValue:r.illegalMove,onChange:function(e){return b(e.target.name)},disabled:t})})]}),r.illegalMove&&Object(X.jsxs)("tr",{className:"settings-item",children:[Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("h3",{className:"text",children:"Times to Allow Illegal Moves"})}),Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("select",{className:"settings-select",name:"illegalMove",id:"timesToAllowIllegalMove",defaultValue:1/0,onChange:function(e){return m(e.target.name,Number(e.target.value))},disabled:t,children:O.map((function(e,t){return Object(X.jsx)("option",{value:e,children:e},t)}))})})]}),Object(X.jsxs)("tr",{className:"settings-item",children:[Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("h3",{className:"text",children:"Allow Takebacks"})}),Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)(Ie,{name:"takeBack",id:"allowTakeBack",small:!0,currentValue:r.takeBack,onChange:function(e){return b(e.target.name)},disabled:t})})]}),r.takeBack&&Object(X.jsxs)("tr",{className:"settings-item",children:[Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("h3",{className:"text",children:"Times to Allow Takebacks"})}),Object(X.jsx)("td",{className:"settings-attr",children:Object(X.jsx)("select",{className:"settings-select",name:"takeBack",id:"timesToAllowTakeBack",defaultValue:1/0,onChange:function(e){return m(e.target.name,Number(e.target.value))},disabled:t,children:O.map((function(e,t){return Object(X.jsx)("option",{value:e,children:e},t)}))})})]})]})})})}),qe=(a(112),function(){var e=Object(s.useContext)(j),t=e.startGame,a=e.setStartGame,n=e.setMyTurn,c=Object(s.useContext)(te),r=c.gameCode,l=c.isHost,i=c.oppUsername,o=c.oppStartGame,d=c.receivedSettings,b=Object(s.useContext)(ke),u=b.username,m=b.colour,O=b.timesToShow,h=b.timesAllowed,g=Object(s.useContext)(Me).setAllCounters,x=Object(s.useContext)(ce),p=x.p2pt,f=x.oppPeerObj,v=x.sendSignal,N=x.sendSettings;console.log(i),We();return Object(X.jsx)("div",{className:"lobby",children:p?Object(X.jsxs)("div",{className:"lobby-container",children:[Object(X.jsx)("h1",{className:"heading",children:"Lobby"}),Object(X.jsxs)("div",{className:"lobby-settings-pane",children:[Object(X.jsx)("h2",{className:"sub-heading",children:"Game Settings"}),Object(X.jsx)(Ke,{disabled:!l||!!t})]}),Object(X.jsxs)("div",{className:"lobby-users-pane",children:[Object(X.jsx)("h2",{className:"sub-heading",children:"Players"}),Object(X.jsxs)("table",{className:"users-table",children:[Object(X.jsx)("thead",{children:Object(X.jsxs)("tr",{className:"users-item",children:[Object(X.jsx)("th",{className:"t-header users-attr",children:Object(X.jsx)("h3",{className:"text text-md wt-500",children:"Name"})}),Object(X.jsx)("th",{className:"t-header users-attr",children:Object(X.jsx)("h3",{className:"text text-md wt-500",children:"Status"})})]})}),Object(X.jsxs)("tbody",{children:[Object(X.jsxs)("tr",{className:"users-item",children:[Object(X.jsx)("td",{className:"text users-attr",children:u}),Object(X.jsx)("td",{className:"text users-attr",children:t?"Ready":"Not Ready"})]}),Object(X.jsxs)("tr",{className:"users-item",children:[Object(X.jsx)("td",{className:"text users-attr",children:0!==i.length?i:"Waiting..."}),Object(X.jsx)("td",{className:"text users-attr",children:0!==i.length?o?"Ready":"Not Ready":"-"})]})]})]}),Object(X.jsxs)("h3",{className:"text mt-3",children:[Object(X.jsx)("strong",{children:"Game Code"})," : ",r]})]}),Object(X.jsxs)("div",{className:"lobby-action-pane",children:[Object(X.jsx)("button",{className:"btn",onClick:function(){f?(l&&N(b),v(be),n("White"===m),g({timesToShow:O,timesAllowed:h}),a(!0)):console.log("wait till peer connects")},disabled:l?!f||t:!d,children:"Start Game"}),l&&t&&Object(X.jsx)("h3",{className:"text",children:"Please wait for the opponent to be ready"}),!l&&!d&&Object(X.jsx)("h3",{className:"text",children:"Please wait for the opponent to configure the settings"}),!l&&d&&Object(X.jsx)("h3",{className:"text",children:"Click Start Game to let the opponent know you're ready!"})]})]}):Object(X.jsxs)("div",{className:"lobby-loading",children:[Object(X.jsxs)("h2",{className:"sub-heading mb-3",children:[l?Object(X.jsx)("span",{children:"Hosting game"}):Object(X.jsx)("span",{children:"Joining game"}),"... Please wait"]}),Object(X.jsx)(Le.a,{})]})})}),Je=a(20),Qe=function(e,t,a,s){var n=e;return t||(n=n.replace("#","")),a||(n=n.replace("+","")),s||(n=n.replace("x","")),n},Ye=(a(119),function(){var e=Object(s.useContext)(j),t=e.chessClient,a=e.myTurn,n=Object(s.useContext)(te),c=n.oppUsername,r=n.gameStatus,l=Object(s.useContext)(ke).username,i=function(e,s){var n=t.getMoveHistory(),c=a?s:e;return n[n.length-c]},o=i(2,1),d=i(1,2),b=d?Object(X.jsxs)("h4",{className:"text status-move",children:["You played ",d]}):a&&Object(X.jsxs)("h4",{className:"text status-main",children:["Make your move, ",l]}),u=o?Object(X.jsxs)("h4",{className:"text status-move",children:[c," played ",o]}):!a&&Object(X.jsxs)("h4",{className:"text status-move",children:["Wait for ",c," to move"]});return Object(X.jsxs)("div",{className:"gamestatus",children:[Object(X.jsx)("h3",{className:"text status-main",children:r.main}),r.winner&&Object(X.jsxs)("h4",{className:"text status-winner",children:[r.winner," ","Draw"!==r.winner?"won":""," by"," ",r.reason]}),!r.winner&&b,!r.winner&&u]})}),$e=(a(120),function(e,t,a){return Object(X.jsx)("div",{className:"move-button",children:Object(X.jsx)("button",{className:"btn",onClick:function(){return a(e)},children:t},e)})}),ze=(a(121),function(){var e=Object(s.useContext)(j),t=e.chessClient,a=(e.setChessClient,e.myTurn),n=e.setMovesPgn,c=e.setMovesFen,r=e.setMyTurn,l=(e.setStartGame,e.resetGameState),i=Object(s.useContext)(te),b=i.gameStatus,u=i.oppUsername,m=i.setGameStatus,O=i.offerRematch,h=i.offerDraw,g=i.requestTakeback,x=i.setOfferRematch,p=i.setOfferDraw,f=i.setRequestTakeback,v=i.resetHumanGameState,N=Object(s.useContext)(ke),w=N.colour,y=N.show,S=(N.timesToShow,N.allow,N.timesAllowed),k=N.illegalMoveLoss,C=y.mate,T=y.checks,E=y.captures,M=Object(s.useContext)(ce),_=M.sendSignal,A=M.sendGameStatus,R=M.sendMove,P=(M.sendChessClient,Object(s.useContext)(Me)),G=P.setCounter,B=(P.decrementCounter,Object(s.useState)("")),D=Object(o.a)(B,2),F=D[0],V=D[1],W=Object(s.useState)(!0),U=Object(o.a)(W,2),L=U[0],H=U[1],I="New Game"!==b.main&&"Active Game"!==b.main,K=function(e){var t=Object(d.a)({},b);t.rematchOffered=!1,"Accept"===e.target.name?(_(me),v(),l()):(_(Oe),A(t),m(t))},q=function(e){var t=Object(d.a)({},b);t.drawOffered=!1,"Accept"===e.target.name?(t.main="Game Drawn",t.reason="Agreement",t.winner="Draw",_(ge)):_(xe),m(t),A(t)},J=function(e){var a=Object(d.a)({},b);a.takebackRequested=!1,"Accept"===e.target.name?(t.undoMove(),n(t.getPgn()),c(t.getFen()),_(fe),r(!1)):_(ve),m(a),A(a)};return Object(X.jsxs)("div",{className:"play",children:[Object(X.jsx)(Ye,{}),Object(X.jsxs)("div",{className:"container-input",children:[Object(X.jsx)("input",{type:"text",name:"move-input",value:F,placeholder:"Enter your move",className:"move-input",onChange:function(e){return V(e.target.value)},disabled:!a||I}),y.legalMoves&&L!==Q&&Object(X.jsx)(X.Fragment,{children:Object(X.jsx)("button",{className:"btn btn-w3",onClick:function(){H((function(e){return!e})),G((function(e){return Object(d.a)(Object(d.a)({},e),{},{legalMoves:P.legalMoves+1})}))},children:"Legal Moves"})}),Object(X.jsx)("button",{className:"btn",onClick:function(){F.length<=7&&(t.isValidMove(F)?(t.move(F),n(t.getPgn()),c(t.getFen()),R(F),function(){var e=t.getStatus(),a=e.main,s=e.reason,n=Object(d.a)({},b);n.main=a,n.reason=s,I&&(n.winner=a.split(" ")[0]),m(n),A(n)}(),r(!1)):function(){if(k&&(G((function(e){return Object(d.a)(Object(d.a)({},e),{},{illegalMoves:P.illegalMoves+1})})),S.illegalMoves<=P.illegalMoves+1)){var e=Object(d.a)({},b);e.main="Game Over",e.winner="White"===w?"Black":"White",e.reason="Illegal move limit exceeded",m(e),_(we),A(e)}}()),V("")},disabled:!a||I,children:"Submit"})]}),L&&Object(X.jsx)("div",{className:"moves-grid",children:t.getLegalMoves().map((function(e){return $e(e,Qe(e,C,T,E),V)}))}),Object(X.jsxs)("div",{className:"play-buttons",children:[Object(X.jsxs)("button",{className:"btn",onClick:function(){p(!0);var e=Object(d.a)({},b);e.drawOffered=!0,m(e),_(he),A(e)},disabled:!a||h||b.drawOffered||I,children:[Object(X.jsx)(Re.a,{icon:Pe.e}),"\xa0 Offer Draw"]}),Object(X.jsxs)("button",{className:"btn",onClick:function(e){f(!0);var t=Object(d.a)({},b);t.takebackRequested=!0,m(t),_(pe),A(t)},disabled:I||0===t.gameHistory().length||a||g||b.takebackRequested||P.takeback>=S.takeback,children:[Object(X.jsx)(Re.a,{icon:Pe.a}),"\xa0 Takeback"]}),Object(X.jsxs)("button",{className:"btn",onClick:function(){var e=Object(d.a)({},b);"White"===w?(e.main="Game Over",e.winner="Black"):(e.main="Game Over",e.winner="White"),e.reason="Resignation",m(e),_(Ne),A(e)},disabled:I,children:[Object(X.jsx)(Re.a,{icon:Je.b}),"\xa0 Resign"]}),Object(X.jsxs)("button",{className:"btn",onClick:function(){x(!0);var e=Object(d.a)({},b);e.rematchOffered=!0,m(e),_(ue),A(e)},disabled:!I||O||b.rematchOffered,children:[Object(X.jsx)(Re.a,{icon:Pe.h}),"\xa0 Rematch"]})]}),b.rematchOffered&&!O&&Object(X.jsxs)(X.Fragment,{children:[Object(X.jsxs)("span",{children:[u," offered a rematch"]}),Object(X.jsx)("button",{name:"Accept",onClick:K,children:"Accept"}),Object(X.jsx)("button",{name:"Decline",onClick:K,children:"Decline"})]}),b.drawOffered&&!h&&Object(X.jsxs)(X.Fragment,{children:[Object(X.jsxs)("span",{children:[u," offered a draw"]}),Object(X.jsx)("button",{name:"Accept",onClick:q,children:"Accept"}),Object(X.jsx)("button",{onClick:q,children:"Decline"})]}),b.takebackRequested&&!g&&Object(X.jsxs)(X.Fragment,{children:[Object(X.jsxs)("span",{children:[u," requested a takeback"]}),Object(X.jsx)("button",{name:"Accept",onClick:J,children:"Accept"}),Object(X.jsx)("button",{onClick:J,children:"Decline"})]})]})}),Xe=(a(122),function(){var e=Object(s.useContext)(j).movesPgn,t=Object(s.useContext)(ke).show,a=t.mate,n=t.captures,c=t.checks,r=function(e){var t=e[0];return{key:t,moveNumber:t,white:e[1]?Qe(e[1],a,c,n):e[1],black:e[2]?Qe(e[2],a,c,n):e[2]}},l=function(){return function(e){var t=e;if(!t)return[];t=t.replace(/(\{[^}]+\})+?/g,"");for(var a=/(\([^\(\)]+\))+?/g;a.test(t);)t=t.replace(a,"");t=(t=(t=t.replace(/\$\d+/g,"")).replace(/(?:1-0|0-1|1\/2-1\/2|\*)$/,"")).replace(/\s\s/g," ").trim();for(var s=[],n=/\d+\.\s?\S+(?:\s+\S+)?/g;;){var c=n.exec(t);if(!c)break;var r=c[0].split(/\s|\.\s?/g);r[0]=parseInt(r[0]),s.push(r)}return s}(e)}().map(r);return console.log(l),Object(X.jsx)("div",{className:"move",children:Object(X.jsxs)("table",{className:"",children:[Object(X.jsx)("thead",{children:Object(X.jsxs)("tr",{children:[Object(X.jsx)("th",{children:"Move No."}),Object(X.jsx)("th",{children:"White"}),Object(X.jsx)("th",{children:"Black"})]})}),Object(X.jsx)("tbody",{children:l.map((function(e,t){return Object(X.jsxs)("tr",{children:[Object(X.jsx)("td",{children:e.moveNumber}),Object(X.jsx)("td",{children:e.white}),Object(X.jsx)("td",{children:e.black})]},t)}))})]})})}),Ze=a(54),et=a.n(Ze),tt=(a(123),function(){var e=Object(s.useContext)(j).movesFen,t=window.screen.width;return Object(X.jsx)("div",{className:"board",children:Object(X.jsx)(et.a,{position:e,draggable:!1,width:t<500?300:500})})}),at=function(){var e=Object(s.useState)(0),t=Object(o.a)(e,2),a=t[0],n=t[1],c=Object(s.useContext)(ke).show,r=Object(s.useContext)(Me),l=r.decrementCounter,i=r.board,j=r.movesTable;return Object(X.jsxs)("div",{children:[Object(X.jsxs)("div",{className:"game-tab",children:[Object(X.jsxs)("button",{className:"play-tab",onClick:function(){return n(0)},children:[Object(X.jsx)(Re.a,{icon:Pe.f}),"\xa0Play"]}),Object(X.jsxs)("button",{className:"moves-tab",onClick:function(){c.movesTable&j>0&&(n(1),l("movesTable"))},children:[Object(X.jsx)(Re.a,{icon:Je.a}),"\xa0Moves"]}),Object(X.jsxs)("button",{className:"board-tab",onClick:function(){c.board&i>0&&(n(2),l("board"))},disabled:!c.board,children:[Object(X.jsx)(Re.a,{icon:Pe.c}),"\xa0Board"]})]}),0===a&&Object(X.jsx)("div",{className:"game-tab-content",children:Object(X.jsx)(ze,{})}),1===a&&Object(X.jsx)("div",{className:"game-tab-content",children:Object(X.jsx)(Xe,{})}),2===a&&Object(X.jsx)("div",{className:"game-tab-content",children:Object(X.jsx)(tt,{})})]})},st=function(e){var t=Object(s.useState)(0),a=Object(o.a)(t,2),n=a[0],c=a[1],r=Object(s.useContext)(j).startGame,l=Object(s.useContext)(te).oppStartGame;return Object(X.jsxs)("main",{children:[0===n&&Object(X.jsx)(Fe,{setView:c}),1===n&&(!r||!l)&&Object(X.jsx)(qe,{setView:c}),1===n&&r&&l&&Object(X.jsx)(at,{setView:c})]})},nt=(a(124),a(26),a(125),a(126),a(127),a(128),a(129),function(){return Object(X.jsxs)("div",{children:[Object(X.jsxs)("h1",{children:[Object(X.jsx)("span",{children:"404"})," Page Not Found"]}),Object(X.jsx)("p",{children:"Sorry, that page doesn't exist."})]})}),ct=(a(130),function(){return Object(X.jsx)(l.a,{children:Object(X.jsxs)("div",{className:"App",children:[Object(X.jsx)(Ge,{}),Object(X.jsxs)(i.c,{children:[Object(X.jsx)(ee,{children:Object(X.jsx)(Ee,{children:Object(X.jsxs)(Ae,{children:[Object(X.jsx)(i.a,{exact:!0,path:"/",component:De}),Object(X.jsx)(i.a,{exact:!0,path:"/play/friend",children:Object(X.jsx)(ne,{children:Object(X.jsx)(Se,{children:Object(X.jsx)(st,{})})})})]})})}),Object(X.jsx)(i.a,{component:nt})]}),Object(X.jsx)(Be,{})]})})});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(Object(X.jsx)(n.a.StrictMode,{children:Object(X.jsx)(ct,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},26:function(e,t){},64:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){},70:function(e,t,a){},91:function(e,t){},93:function(e,t){}},[[131,1,2]]]);
//# sourceMappingURL=main.6ca501f2.chunk.js.map